<?xml version="1.0" encoding="utf-8"?>
<s:TitleWindow xmlns:fx="http://ns.adobe.com/mxml/2009"
			   xmlns:s="library://ns.adobe.com/flex/spark"
			   xmlns:mx="library://ns.adobe.com/flex/mx"
			   width="450"
			   height="135"
			   creationComplete="init(event)"
			   close="closeHandler(event)"
			   title="创建项目">
	<fx:Script>
		<![CDATA[
			import mx.controls.Alert;
			import mx.events.CloseEvent;
			import mx.events.FlexEvent;
			import mx.managers.PopUpManager;
			
			import core.Config;
			import manager.LocalShareManager;


			protected function closeHandler(event : CloseEvent = null) : void
			{
				PopUpManager.removePopUp(this);
			}

			protected function init(event : FlexEvent) : void
			{
				x = (Config.stage.stageWidth - width) * .5;
				y = (Config.stage.stageHeight - height) * .5;

				if (LocalShareManager.getInstance().get("project") == null)
					txt_url.text = File.applicationDirectory.nativePath;
				else
					txt_url.text = LocalShareManager.getInstance().get("project");
			}

			protected function btnClick(evt : Event) : void
			{
				var file : File = new File();
				if (LocalShareManager.getInstance().get("project"))
					file.nativePath = LocalShareManager.getInstance().get("project");
				file.browseForDirectory("选择");
				file.addEventListener(Event.SELECT, onSelect);

				function onSelect(evt : Event) : void
				{
					txt_url.text = file.nativePath;
					LocalShareManager.getInstance().save("project", file.nativePath);
				}
			}

			protected function btn1Click(evt : Event) : void
			{
				var file : File = new File();
				if (LocalShareManager.getInstance().get("project_res"))
					file.nativePath = LocalShareManager.getInstance().get("project_res");
				file.browseForDirectory("选择");
				file.addEventListener(Event.SELECT, onSelect);

				function onSelect(evt : Event) : void
				{
					txt_resUrl.text = file.nativePath;
					LocalShareManager.getInstance().save("project_res", file.nativePath);
				}
			}

			protected function createClick(evt : Event) : void
			{
				if (txt_name.text == "")
				{
					Alert.show("请输入项目名!");
					return;
				}
				if (txt_resUrl.text == "")
				{
					Alert.show("请选择资源目录!");
					return;
				}
				var file : File = new File(txt_url.text + "\\" + txt_name.text);
				!file.exists && file.createDirectory();
				var nativePath : String = file.nativePath;
				var fileNanme : String = file.name;
				Config._url_project = nativePath;
				Config.saveProject();
				LocalShareManager.getInstance().save("project_url", nativePath);
				PopUpManager.removePopUp(this);
			}
		]]>
	</fx:Script>
	<fx:Declarations>
		<!-- 将非可视元素（例如服务、值对象）放在此处 -->
	</fx:Declarations>
	<s:VGroup paddingTop="10"
			  paddingLeft="10">
		<s:HGroup>
			<s:Label text="项目名称"/>
			<s:TextInput width="300"
						 id="txt_name"/>
			<s:Button label="创建"
					  click="createClick(event)"/>
		</s:HGroup>
		<s:HGroup>
			<s:Label text="项目地址"/>
			<s:TextInput editable="false"
						 width="300"
						 id="txt_url"/>
			<s:Button label="浏览"
					  click="btnClick(event)"/>
		</s:HGroup>
		<s:HGroup>
			<s:Label text="资源地址"/>
			<s:TextInput editable="false"
						 width="300"
						 id="txt_resUrl"/>
			<s:Button label="浏览"
					  click="btn1Click(event)"/>
		</s:HGroup>
	</s:VGroup>
</s:TitleWindow>
